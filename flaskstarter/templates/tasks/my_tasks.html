{% from "macros/_form.html" import render_form %}

{% set page_title = 'My Tasks' %}

{% extends 'layouts/base.html' %}

{% block body %}
{% include 'layouts/banner.html' %}
<div class="container data">
  <div class="row justify-content-center">
    <h1>Explore Data</h1>
  </div>
  <div class="row mt-5">
    <form action="{{ url_for('tasks.showall')}}" method="post" style="display:inline-block">
      <button class="btn btn-primary active" name="showall" type="submit"> Show All</button>
    </form>

    <form action="{{ url_for('tasks.age_filter')}}" method="post" style="display:inline-block">
      <button class="btn btn-primary" name="age52" type="submit"> Age = 52</button>
    </form>

    <table id="data" class="table table-hover">
      <thead>
        <tr>
          <th>sample_id</th>
          <th>donor</th>
          <th>X</th>
          <th>age</th>
          <th>status</th>
          <th>dataset</th>
        </tr>
      </thead>
      <tbody>

        {% for task in all_tasks %}
        <tr>
          <td>{{ task.sample_id }}</td>
          <td>{{ task.donor }}</td>
          <td>{{ task.X }}</td>
          <td>{{ task.age }}</td>
          <td>{{ task.Status_on_day_collection_summary }}</td>
          <td>{{ task.dataset }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="button d-flex justify-content-center">
    <form action="{{ url_for('tasks.download')}}" method="post" style="display:inline-block">
      <button class="btn btn-outline-success" name="download" type="submit"> Download Full-set / Sub-set Data </button>
    </form>
  </div>
</div>

<div class="citation flex-column ">
  <div class="container">
    <div class="citation-h">
      APA 7th edition
    </div>
    <div class="line">
    </div>
    <div class="d-flex justify-content-start">
      <div class="citation-text" id="c1">
        2.5 million Single Cell (2022, February 23). The Laboratory of Data Discovery for Health.
      </div>
      <div class="copy"> <button type="button" id="copy" class="btn btn-success"
          onclick="copy()">Copy<br>Citation</button></div>

    </div>

    <div class="citation-link">
      https://www.d24.hk/
    </div>
    <div class="citation-t">
      Citation
    </div>
  </div>
</div>
{% include 'layouts/footer.html' %}
{% endblock %}

{% block scripts %}
<script>
  $(document).ready(function () {
    $('#data').DataTable();
  });

  $('select').selectpicker();

  document.getElementById('select').onclick = function () {
    var selected = [];
    for (var option of document.getElementById('multiselect').options) {
      if (option.selected) {
        selected.push(option.value);
      }
    }
    alert("Successfully selected the following donors for filtering" + selected);

  }
</script>
<script>
  function copy() {
  var $temp = $("<input>");
  $("body").append($temp);
  $temp.val("2.5 million Single Cell (2022, February 23). The Laboratory of Data Discovery for Health. https://www.d24.hk/").select();
  document.execCommand("copy");
  $temp.remove();
  alert("copied")

  }
</script>

{% endblock %}